#Consultas TP1 de IBD

1. 

SELECT COD_FUNCAO, NOME_FUNCAO 
FROM FUNCAO NATURAL JOIN DETALHAMENTO_FUNCAO NATURAL JOIN SUBFUNCAO 
WHERE NOME_SUBFUNCAO = 
(SELECT NOME_SUBFUNCAO 
FROM FUNCAO NATURAL JOIN DETALHAMENTO_FUNCAO NATURAL JOIN SUBFUNCAO 
GROUP BY NOME_SUBFUNCAO ORDER BY COUNT(NOME_SUBFUNCAO) DESC LIMIT 1);

6. 

SELECT NOME_FUNCAO, NOME_SUBFUNCAO, VALOR_DESPESA 
FROM FUNCAO NATURAL JOIN DETALHAMENTO_FUNCAO NATURAL JOIN SUBFUNCAO NATURAL JOIN DESPESA_PUBLICA 
WHERE ANO_DESPESA = 2018 AND MES_DESPESA > 7 
ORDER BY VALOR_DESPESA DESC;

7.

SELECT NOME_PROGRAMA_GOVERNO, COUNT(DISTINCT NOME_ORGAO) AS NUMERO_ORGAOS_DISTINTOS 
FROM ORGAO NATURAL JOIN DESPESA_PUBLICA NATURAL JOIN PROGRAMA_GOVERNO 
WHERE VALOR_DESPESA > 0 
GROUP BY NOME_PROGRAMA_GOVERNO;

2.

SELECT NOME_FUNCAO, NOME_SUBFUNCAO, AVG(VALOR_DESPESA) AS MEDIA_DESPESA_FUNCAO_SUBFUNCAO 
FROM FUNCAO NATURAL JOIN DETALHAMENTO_FUNCAO NATURAL JOIN SUBFUNCAO NATURAL JOIN DESPESA_PUBLICA 
GROUP BY NOME_FUNCAO, NOME_SUBFUNCAO 
HAVING MEDIA_DESPESA_FUNCAO_SUBFUNCAO > 1000;

3.

SELECT NOME_PROGRAMA_GOVERNO, VALOR_DESPESA 
FROM DESPESA_PUBLICA NATURAL JOIN ORGAO NATURAL JOIN PROGRAMA_GOVERNO 
WHERE ANO_DESPESA = 2018 
ORDER BY VALOR_DESPESA DESC;

4.

SELECT MES_DESPESA, ANO_DESPESA, MODALIDADE_DESPESA, NOME_PROGRAMA_GOVERNO, VALOR_DESPESA 
FROM DESPESA_PUBLICA NATURAL JOIN ORGAO NATURAL JOIN PROGRAMA_GOVERNO 
WHERE ANO_DESPESA = 2018 AND NOME_ORGAO = 'Ministério da Educação' AND MES_DESPESA < 7 
ORDER BY VALOR_DESPESA DESC;

12.

SELECT DISTINCT NOME_FUNCAO, VALOR_DESPESA 
FROM FUNCAO NATURAL JOIN DETALHAMENTO_FUNCAO NATURAL JOIN DESPESA_PUBLICA;

13.

SELECT DISTINCT MODALIDADE_DESPESA, VALOR_DESPESA, NOME_ORGAO 
FROM ORGAO NATURAL JOIN DESPESA_PUBLICA 
WHERE MODALIDADE_DESPESA = 'Reserva de Contingência';

14. 

SELECT DISTINCT VALOR_DESPESA, NOME_PROGRAMA_GOVERNO 
FROM DESPESA_PUBLICA NATURAL JOIN PROGRAMA_GOVERNO 
WHERE NOME_PROGRAMA_GOVERNO = 'ENEM';

15.

SELECT DISTINCT NOME_PROGRAMA_GOVERNO, QTD_ORGAOS_SUBORDINADOS, VALOR_DESPESA 
FROM DESPESA_PUBLICA NATURAL JOIN ORGAO NATURAL JOIN PROGRAMA_GOVERNO 
WHERE NOME_ORGAO = 'Ministério da Educação';
